{
    "sourceFile": "src/pages/Home.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 6,
            "patches": [
                {
                    "date": 1765474858499,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1768156313218,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,20 +9,52 @@\n import { Link } from \"react-router-dom\";\n import MosaicProgressBar from \"../components/MosaicProgressBar\";\n import LiveCamera from \"../components/LiveCamera\";\n import { getHighlightedPhotos } from \"../services/photoService\";\n+import { getPublicStats } from \"../services/statsService\";\n+import {}\n \n export default function Home() {\n-  const { total: onlineTotal = 0, anonymousCount = 0, count: registeredOnline = 0 } =\n-    useOnlineUsers();\n+  const {\n+    total: onlineTotal = 0,\n+    anonymousCount = 0,\n+    count: registeredOnline = 0,\n+  } = useOnlineUsers();\n \n   const [theme, setTheme] = useState(\"day\");\n-  const [stats] = useState({\n-    fotos: 1523,\n-    colaboradores: 847,\n-    paises: 27,\n+  const [stats, setStats] = useState({\n+    fotos: 0,\n+    colaboradores: 0,\n+    paises: 0,\n   });\n+  const [loadingStats, setLoadingStats] = useState(true);\n+  const [statsError, setStatsError] = useState(\"\");\n \n+  useEffect(() => {\n+    const fetchStats = async () => {\n+      setLoadingStats(true);\n+      setStatsError(\"\");\n+      try {\n+        const data = await getPublicStats();\n+        setStats({\n+          fotos: data?.photos ?? 0,\n+          colaboradores: data?.collaborators ?? 0,\n+          paises: data?.countries ?? 0,\n+        });\n+      } catch (err) {\n+        console.error(\"Error al cargar estadísticas:\", err);\n+        setStatsError(\n+          err?.response?.data?.message ||\n+            \"No se pudieron cargar las estadísticas.\"\n+        );\n+      } finally {\n+        setLoadingStats(false);\n+      }\n+    };\n+\n+    fetchStats();\n+  }, []);\n+\n   // Theme automático por hora\n   useEffect(() => {\n     const hour = new Date().getHours();\n     if (hour >= 21 || hour < 6) setTheme(\"sunset\");\n@@ -127,41 +159,46 @@\n             </Link>\n           </div>\n         </div>\n       </section>\n-      \n \n       {/* HERO MOSAICO */}\n       <section className=\"hero-preview\">\n-       <Link to=\"/mosaic\">\n-        <img\n-          src={heroPic}\n-          alt=\"Vista previa del mosaico colaborativo de la Sagrada Família\"\n-          loading=\"lazy\"\n-          className=\"hero-clickable\"\n-        />\n-       </Link>\n+        <Link to=\"/mosaic\">\n+          <img\n+            src={heroPic}\n+            alt=\"Vista previa del mosaico colaborativo de la Sagrada Família\"\n+            loading=\"lazy\"\n+            className=\"hero-clickable\"\n+          />\n+        </Link>\n       </section>\n \n-\n       <MosaicProgressBar />\n \n       {/* ESTADÍSTICAS */}\n       <section className=\"stats-section\">\n         <h3 className=\"stats-title\">Nuestra comunidad en cifras</h3>\n+        {statsError && (\n+          <p className=\"text-red-600 text-sm mb-2\">{statsError}</p>\n+        )}\n         <div className=\"stats-grid\">\n           <div className=\"stat-item\">\n-            <span className=\"stat-number\">{stats.fotos.toLocaleString()}</span>\n+            <span className=\"stat-number\">\n+              {loadingStats ? \"...\" : stats.fotos.toLocaleString()}\n+            </span>\n             <span className=\"stat-label\">Fotos subidas</span>\n           </div>\n           <div className=\"stat-item\">\n             <span className=\"stat-number\">\n-              {stats.colaboradores.toLocaleString()}\n+              {loadingStats ? \"...\" : stats.colaboradores.toLocaleString()}\n             </span>\n             <span className=\"stat-label\">Colaboradores</span>\n           </div>\n           <div className=\"stat-item\">\n-            <span className=\"stat-number\">{stats.paises}</span>\n+            <span className=\"stat-number\">\n+              {loadingStats ? \"...\" : stats.paises}\n+            </span>\n             <span className=\"stat-label\">Países participantes</span>\n           </div>\n           <div className=\"stat-item\">\n             <span className=\"stat-number\">{onlineTotal || 0}</span>\n@@ -238,16 +275,17 @@\n                   </button>\n                 </div>\n \n                 {/* Indicadores */}\n-                <div className=\"flex justify-center gap-2 py-4 bg-base-100\">\n+                <div className=\"flex justify-center gap-3 py-4 bg-base-100\">\n                   {rawSlides.map((_, i) => (\n                     <button\n                       key={i}\n                       onClick={() => setCurrentSlide(i)}\n-                      className={`btn btn-xs ${\n-                        i === currentSlide ? \"btn-primary\" : \"\"\n+                      className={`carousel-dot ${\n+                        i === currentSlide ? \"is-active\" : \"\"\n                       }`}\n+                      type=\"button\"\n                     >\n                       {i + 1}\n                     </button>\n                   ))}\n@@ -265,11 +303,11 @@\n           <a href=\"/api/docs\">API Docs</a>\n           <a href=\"https://github.com\" target=\"_blank\" rel=\"noreferrer\">\n             GitHub\n           </a>\n-          </p>\n-          © {new Date().getFullYear()} Proyecto colaborativo Sagrada Família API\n-          — Desarrollado por el equipo Full Stack 2025.\n+        </p>\n+        © {new Date().getFullYear()} Proyecto colaborativo Sagrada Família API —\n+        Desarrollado por el equipo Full Stack 2025.\n       </footer>\n \n       <LiveCamera />\n     </main>\n"
                },
                {
                    "date": 1768156655708,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,9 +10,8 @@\n import MosaicProgressBar from \"../components/MosaicProgressBar\";\n import LiveCamera from \"../components/LiveCamera\";\n import { getHighlightedPhotos } from \"../services/photoService\";\n import { getPublicStats } from \"../services/statsService\";\n-import {}\n \n export default function Home() {\n   const {\n     total: onlineTotal = 0,\n"
                },
                {
                    "date": 1768157824297,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,8 +10,9 @@\n import MosaicProgressBar from \"../components/MosaicProgressBar\";\n import LiveCamera from \"../components/LiveCamera\";\n import { getHighlightedPhotos } from \"../services/photoService\";\n import { getPublicStats } from \"../services/statsService\";\n+import UserPage from \"./UserPage\";\n \n export default function Home() {\n   const {\n     total: onlineTotal = 0,\n"
                },
                {
                    "date": 1768158253238,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -104,8 +104,12 @@\n   }, [highlighted, slideCount]);\n \n   return (\n     <main className=\"home\">\n+      {/* Button link to UserPage */}\n+      <Link to=\"/user-page\" className=\"user-page-link\">\n+        My Photos\n+      </Link>\n       {/* Botón para alternar el modo manualmente */}\n       <button\n         className=\"theme-toggle\"\n         aria-label=\"Cambiar entre modo día y atardecer\"\n"
                },
                {
                    "date": 1768158585775,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,9 +10,8 @@\n import MosaicProgressBar from \"../components/MosaicProgressBar\";\n import LiveCamera from \"../components/LiveCamera\";\n import { getHighlightedPhotos } from \"../services/photoService\";\n import { getPublicStats } from \"../services/statsService\";\n-import UserPage from \"./UserPage\";\n \n export default function Home() {\n   const {\n     total: onlineTotal = 0,\n@@ -105,9 +104,9 @@\n \n   return (\n     <main className=\"home\">\n       {/* Button link to UserPage */}\n-      <Link to=\"/user-page\" className=\"user-page-link\">\n+      <Link to=\"/userPage\" className=\"user-page-link\">\n         My Photos\n       </Link>\n       {/* Botón para alternar el modo manualmente */}\n       <button\n"
                },
                {
                    "date": 1768158807805,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -105,9 +105,9 @@\n   return (\n     <main className=\"home\">\n       {/* Button link to UserPage */}\n       <Link to=\"/userPage\" className=\"user-page-link\">\n-        My Photos\n+        Mis Fotos\n       </Link>\n       {/* Botón para alternar el modo manualmente */}\n       <button\n         className=\"theme-toggle\"\n"
                }
            ],
            "date": 1765474858499,
            "name": "Commit-0",
            "content": "// src/pages/Home.jsx\nimport React, { useState, useEffect } from \"react\";\nimport \"./Home.css\";\nimport heroPic from \"../assets/heroPicSagradaFamilia.png\";\nimport iconNacimiento from \"../assets/iconNacimiento.png\";\nimport iconPasion from \"../assets/iconPasion.png\";\nimport FactSection from \"../components/FactSection\";\nimport useOnlineUsers from \"../hooks/useOnlineUsers\";\nimport { Link } from \"react-router-dom\";\nimport MosaicProgressBar from \"../components/MosaicProgressBar\";\nimport LiveCamera from \"../components/LiveCamera\";\nimport { getHighlightedPhotos } from \"../services/photoService\";\n\nexport default function Home() {\n  const { total: onlineTotal = 0, anonymousCount = 0, count: registeredOnline = 0 } =\n    useOnlineUsers();\n\n  const [theme, setTheme] = useState(\"day\");\n  const [stats] = useState({\n    fotos: 1523,\n    colaboradores: 847,\n    paises: 27,\n  });\n\n  // Theme automático por hora\n  useEffect(() => {\n    const hour = new Date().getHours();\n    if (hour >= 21 || hour < 6) setTheme(\"sunset\");\n    else setTheme(\"day\");\n  }, []);\n\n  // Aplicar el tema\n  useEffect(() => {\n    document.documentElement.setAttribute(\"data-theme\", theme);\n  }, [theme]);\n\n  // Fotos destacadas\n  const [highlighted, setHighlighted] = useState(null);\n  const [slideCount, setSlideCount] = useState(0);\n  const [currentSlide, setCurrentSlide] = useState(0);\n\n  useEffect(() => {\n    const fetchHighlighted = async () => {\n      try {\n        const data = await getHighlightedPhotos();\n        setHighlighted(data);\n\n        const slides = [\n          data?.oldestByYear?.imageUrl,\n          data?.newestUploaded?.imageUrl,\n          data?.mostLiked?.imageUrl,\n        ].filter(Boolean);\n\n        setSlideCount(slides.length);\n      } catch (error) {\n        console.error(\"Error al cargar fotos destacadas:\", error);\n      }\n    };\n\n    fetchHighlighted();\n  }, []);\n\n  // Autoplay SIN hash, SIN scroll //\n  useEffect(() => {\n    if (!highlighted || slideCount === 0) return;\n\n    const interval = setInterval(() => {\n      setCurrentSlide((prev) => (prev + 1) % slideCount);\n    }, 5000);\n\n    return () => clearInterval(interval);\n  }, [highlighted, slideCount]);\n\n  return (\n    <main className=\"home\">\n      {/* Botón para alternar el modo manualmente */}\n      <button\n        className=\"theme-toggle\"\n        aria-label=\"Cambiar entre modo día y atardecer\"\n      >\n        <img\n          src={theme === \"day\" ? iconPasion : iconNacimiento}\n          alt={\n            theme === \"day\"\n              ? \"Modo día - Fachada Nacimiento\"\n              : \"Modo atardecer - Fachada Pasión\"\n          }\n          className=\"theme-icon\"\n        />\n      </button>\n\n      {/* FACTS */}\n      <section className=\"fact-section\" aria-labelledby=\"fact-title\">\n        <div className=\"fact-inner\">\n          <FactSection />\n        </div>\n      </section>\n\n      {/* INTRODUCCIÓN */}\n      <section className=\"intro-section\" aria-labelledby=\"intro-title\">\n        <div className=\"intro-inner\">\n          <h2 id=\"intro-title\" className=\"intro-title\">\n            Un homenaje colaborativo a la Sagrada Família\n          </h2>\n\n          <p className=\"intro-text\">\n            Con motivo de la inauguración de la Sagrada Família en 2026, hemos\n            querido rendir nuestro pequeño homenaje con este proyecto\n            colaborativo.\n          </p>\n\n          <p className=\"intro-text\">\n            Inspirados por el espíritu participativo de Barcelona, invitamos a\n            cualquier persona a aportar su propia fotografía.\n          </p>\n\n          <p className=\"intro-tagline\">\n            Cada imagen cuenta una parte de esta historia. ¡Suma la tuya ahora!\n          </p>\n\n          <div className=\"intro-cta\">\n            <Link to=\"/email\" className=\"btn btn-primary\">\n              Colabora con tu foto\n            </Link>\n            <Link to=\"/mosaic\" className=\"btn-link\">\n              Ver el mosaico\n            </Link>\n          </div>\n        </div>\n      </section>\n      \n\n      {/* HERO MOSAICO */}\n      <section className=\"hero-preview\">\n       <Link to=\"/mosaic\">\n        <img\n          src={heroPic}\n          alt=\"Vista previa del mosaico colaborativo de la Sagrada Família\"\n          loading=\"lazy\"\n          className=\"hero-clickable\"\n        />\n       </Link>\n      </section>\n\n\n      <MosaicProgressBar />\n\n      {/* ESTADÍSTICAS */}\n      <section className=\"stats-section\">\n        <h3 className=\"stats-title\">Nuestra comunidad en cifras</h3>\n        <div className=\"stats-grid\">\n          <div className=\"stat-item\">\n            <span className=\"stat-number\">{stats.fotos.toLocaleString()}</span>\n            <span className=\"stat-label\">Fotos subidas</span>\n          </div>\n          <div className=\"stat-item\">\n            <span className=\"stat-number\">\n              {stats.colaboradores.toLocaleString()}\n            </span>\n            <span className=\"stat-label\">Colaboradores</span>\n          </div>\n          <div className=\"stat-item\">\n            <span className=\"stat-number\">{stats.paises}</span>\n            <span className=\"stat-label\">Países participantes</span>\n          </div>\n          <div className=\"stat-item\">\n            <span className=\"stat-number\">{onlineTotal || 0}</span>\n            <span className=\"stat-label\">Personas viendo ahora</span>\n          </div>\n        </div>\n      </section>\n\n      {/* CARRUSEL SIN HASH */}\n      <section className=\"carousel-section\">\n        <h2 className=\"section-title\">Destacados del mosaico</h2>\n\n        {!highlighted ? (\n          <p>Cargando...</p>\n        ) : (\n          (() => {\n            const rawSlides = [\n              {\n                title: \"La más antigua\",\n                description: `Capturada en ${\n                  highlighted.oldestByYear?.year || \"año desconocido\"\n                }.`,\n                src: highlighted.oldestByYear?.imageUrl,\n              },\n              {\n                title: \"La más reciente\",\n                description: \"Tomada recientemente por un colaborador.\",\n                src: highlighted.newestUploaded?.imageUrl,\n              },\n              {\n                title: \"La más votada\",\n                description: `Con ${highlighted.mostLiked?.likes || 0} likes.`,\n                src: highlighted.mostLiked?.imageUrl,\n              },\n            ].filter((s) => !!s.src);\n\n            return (\n              <div className=\"w-full max-w-3xl mx-auto rounded-lg shadow-lg overflow-hidden relative\">\n                {/* Imagen */}\n                <div className=\"relative w-full h-[500px] flex items-center justify-center bg-black/5\">\n                  <img\n                    src={rawSlides[currentSlide].src}\n                    alt={rawSlides[currentSlide].title}\n                    className=\"w-full h-full object-contain\"\n                  />\n\n                  {/* Texto superpuesto */}\n                  <div className=\"absolute bottom-0 left-0 w-full bg-black bg-opacity-50 text-white p-4\">\n                    <h3 className=\"text-lg font-semibold\">\n                      {rawSlides[currentSlide].title}\n                    </h3>\n                    <p>{rawSlides[currentSlide].description}</p>\n                  </div>\n\n                  {/* Flechas de navegación */}\n                  <button\n                    onClick={() =>\n                      setCurrentSlide(\n                        (currentSlide - 1 + rawSlides.length) % rawSlides.length\n                      )\n                    }\n                    className=\"btn btn-circle absolute left-5 top-1/2 -translate-y-1/2\"\n                  >\n                    ❮\n                  </button>\n\n                  <button\n                    onClick={() =>\n                      setCurrentSlide((currentSlide + 1) % rawSlides.length)\n                    }\n                    className=\"btn btn-circle absolute right-5 top-1/2 -translate-y-1/2\"\n                  >\n                    ❯\n                  </button>\n                </div>\n\n                {/* Indicadores */}\n                <div className=\"flex justify-center gap-2 py-4 bg-base-100\">\n                  {rawSlides.map((_, i) => (\n                    <button\n                      key={i}\n                      onClick={() => setCurrentSlide(i)}\n                      className={`btn btn-xs ${\n                        i === currentSlide ? \"btn-primary\" : \"\"\n                      }`}\n                    >\n                      {i + 1}\n                    </button>\n                  ))}\n                </div>\n              </div>\n            );\n          })()\n        )}\n      </section>\n\n      {/* FOOTER */}\n      <footer className=\"footer\">\n        <p className=\"footer-text\">\n          <a href=\"/about\">Sobre el proyecto</a>\n          <a href=\"/api/docs\">API Docs</a>\n          <a href=\"https://github.com\" target=\"_blank\" rel=\"noreferrer\">\n            GitHub\n          </a>\n          </p>\n          © {new Date().getFullYear()} Proyecto colaborativo Sagrada Família API\n          — Desarrollado por el equipo Full Stack 2025.\n      </footer>\n\n      <LiveCamera />\n    </main>\n  );\n}\n"
        }
    ]
}